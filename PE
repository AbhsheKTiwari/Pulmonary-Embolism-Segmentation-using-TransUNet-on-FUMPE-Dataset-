Pulmonary Embolism Segmentation using TransUNet on FUMPE Dataset

This repository contains the implementation of a Transformer-based TransUNet model applied to the FUMPE Dataset (Kaggle) for Pulmonary Embolism (PE) segmentation from CT scan slices.
The project focuses on preprocessing, training with Dice loss, and achieving robust segmentation performance.

ğŸš€ Project Overview

Pulmonary Embolism (PE) is a critical and potentially fatal condition requiring timely diagnosis.
This project utilizes TransUNet, a hybrid CNN + Transformer architecture, to segment embolism regions from CT images.

Timeline: Marâ€“Apr 2025, Aug 2025

Model: TransUNet

Dataset: FUMPE (Fully Unsupervised Method for Pulmonary Embolism) â€“ Kaggle

Task: Semantic segmentation of pulmonary embolism regions

Loss Function: Dice Loss

Best Result: Dice Coefficient â‰ˆ 0.852 at 50 epochs

ğŸ“‚ Dataset Structure

Download the dataset from Kaggle and place it as:

dataset/
 â”œâ”€â”€ train/
 â”‚   â”œâ”€â”€ images/
 â”‚   â””â”€â”€ masks/
 â”œâ”€â”€ val/
 â”‚   â”œâ”€â”€ images/
 â”‚   â””â”€â”€ masks/
 â””â”€â”€ test/
     â”œâ”€â”€ images/
     â””â”€â”€ masks/


Each folder contains CT slices (.dcm) and corresponding PE masks(.mat).

ğŸ› ï¸ Technologies Used

Python

TensorFlow / Keras

NumPy

Matplotlib

OpenCV (optional preprocessing)

TransUNet architecture

ğŸ“¦ Installation

Clone the repository:

git clone https://github.com/AbhsheKTiwari/Pulmonary-Embolism-Segmentation-using-TransUNet-on-FUMPE-Dataset.git
cd Pulmonary-Embolism-Segmentation-using-TransUNet-on-FUMPE-Dataset


Install dependencies:

pip install -r requirements.txt

ğŸ§¹ Preprocessing

The following steps were applied:

CT slice normalization

CLAHE (optional)

Resizing to 256Ã—256

Mask alignment

Data augmentation (rotation, flips)

Example preprocessing snippet:

img = cv2.resize(img, (256, 256))
mask = cv2.resize(mask, (256, 256))
img = img / 255.0

ğŸ§  Model Architecture: TransUNet

TransUNet combines:

CNN Encoder (ResNet / UNet-encoder)

Transformer Block

UNet-style Decoder

This hybrid structure helps capture global context from PE lesions while preserving spatial details.

Architecture summary:

model = TransUNet(img_dim=256, channels=1, num_classes=1)
model.compile(optimizer='adam', loss=dice_loss, metrics=[dice_coef])

ğŸ¯ Training

Training settings:

Epochs: 50

Batch Size: 8

Optimizer: Adam

Loss: Dice Loss

Metrics: Dice Coefficient

Run training:

python train.py

ğŸ“ˆ Results

Dice Coefficient: â‰ˆ 0.852 at 50 epochs

Training Stability: Smooth convergence

Clear segmentation boundaries in PE regions

Example output (insert your generated segmentation examples):

results/
 â”œâ”€â”€ sample_output_1.png
 â”œâ”€â”€ sample_output_2.png
 â””â”€â”€ training_curve.png

ğŸ§ª Evaluation

Evaluate on test set:

python evaluate.py


Outputs:

Test Dice Score

Predicted vs. Ground Truth masks

Visual results stored in /results/

ğŸ“˜ Repository Structure
ğŸ“ Pulmonary-Embolism-Segmentation-using-TransUNet-on-FUMPE-Dataset
â”‚
â”œâ”€â”€ train.py
â”œâ”€â”€ model.py
â”œâ”€â”€ utils.py
â”œâ”€â”€ evaluate.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ README.md
â””â”€â”€ results/
